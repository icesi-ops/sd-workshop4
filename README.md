Sebastian Navia Ramirez
Consul:
To run the Consul use the following command (VERSION 1.15):
- docker run -d -p 8500:8500 -p 8600:8600/udp --network distribuidos2 --name consul consul:1.15 agent -server -bootstrap-expect 1 -ui -data-dir /tmp -client=0.0.0.0
![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/0052b1d4-fdfa-41a2-815c-58bd211e03bc)

To ensure that all our services are displayed on the page generated by the consul, you must enter the following 2 lines in all services, in their respective "build.gradle", located in each of your folders.

-implementation 'org.springframework.boot:spring-boot-starter-actuator'
-implementation 'org.springframework.cloud:spring-cloud-starter-consul-discovery'

Now, in each service go to src/main/resources/ and enter application.propiertis and paste this code.
Example with app-pay service:

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/b7a91d25-17e1-4f07-9fa1-b86cc1935ad6)

-# Consul
-spring.cloud.consul.host=consul
-spring.cloud.consul.port=8500
-spring.cloud.consul.discovery.health-check-interval=5s
-spring.cloud.consul.discovery.prefer-ip-address=true
We save the image of each service and run the image.

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/c85b69d8-622d-4ff2-964f-d6f2ba392b7e)

Install dnsmasq Service:

Begin by installing the dnsmasq service, which provides DNS functionality.
- sudo apt-get install dnsmasq

Create Configuration File:

Create a new file, let's name it '10-consul', in the etc/dnsmasq.d directory.
-sudo nano /etc/dnsmasq.d/10-consul

Add the following line to the file, specifying the Consul server with the loopback address and port:
-Server=/consul/127.0.0.1#8600

Restart dnsmasq Service:

Restart the dnsmasq service to apply the changes.

Modify resolv.conf:

Edit the resolv.conf file to enable DNS resolution for services:
-sudo nano /etc/resolv.conf

Add the following line to the file
-nameserver 127.0.0.1

Verify DNS Resolution:

Confirm that the DNS service is resolving the IP addresses of each microservice.
dig <service_name>.service.consul
Example:

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/8747b93d-1e8c-4350-8bf2-34ea38d148fe)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/4b05684b-965d-4eca-8dcf-415b21f51ce3)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/b963d6ad-b34e-42e0-ab39-be37f0483712)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/82e1b0e5-02d7-48ac-b771-b3981ff5b2f9)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/5890edc0-ba4f-4340-8a1d-9aeb62480f80)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/25838b44-7d38-49ed-b1ac-d1c08684b5fd)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/acaa673b-3c77-4e0b-98e2-ec5e0a73a806)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/5ce53e98-1b77-433f-b4ed-8970b98e056f)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/3193d27c-860d-45d8-8cb6-bd6210db6c71)

![imagen](https://github.com/Sebastianavia/sd-workshop4/assets/71205906/dd018e1c-c6c7-460f-9dde-aeeacc23cd92)



















